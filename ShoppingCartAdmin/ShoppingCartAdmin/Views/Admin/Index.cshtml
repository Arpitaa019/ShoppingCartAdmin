@{
    ViewData["Title"] = "AdminSellerDetails";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}
<h2 style="margin-bottom:30px;">Admin Dashboard</h2>

<!-- Summary Cards -->
<div style="display:flex; gap:20px; margin-bottom:40px;">
    <div style="flex:1; background-color:#3498db; color:white; padding:20px; border-radius:8px;">
        <h4>Total Customers</h4>
        <p id="totalCustomers" style="font-size:24px;">--</p>
    </div>
    <div style="flex:1; background-color:#2ecc71; color:white; padding:20px; border-radius:8px;">
        <h4>Active Sellers</h4>
        <p id="activeSellers" style="font-size:24px;">--</p>
    </div>
    <div style="flex:1; background-color:#f1c40f; color:black; padding:20px; border-radius:8px;">
        <h4>Orders In Transit</h4>
        <p id="ordersTransit" style="font-size:24px;">--</p>
    </div>
    <div style="flex:1; background-color:#1abc9c; color:white; padding:20px; border-radius:8px;">
        <h4>Total Revenue</h4>
        <p id="totalRevenue" style="font-size:24px;">--</p>
    </div>
</div>

<!-- Customers Table -->
<h3>Customers</h3>
<table style="width:100%; border-collapse:collapse; background-color:white; margin-bottom:40px;">
    <thead>
        <tr style="background-color:#ecf0f1;">
            <th style="padding:10px; border:1px solid #ccc;">Name</th>
            <th style="padding:10px; border:1px solid #ccc;">Email</th>
            <th style="padding:10px; border:1px solid #ccc;">Mobile</th>
            <th style="padding:10px; border:1px solid #ccc;">Status</th>
            <th style="padding:10px; border:1px solid #ccc;">Actions</th>
        </tr>
    </thead>
    <tbody id="customerTable"></tbody>
</table>

<!-- Sellers Table -->
<h3>Sellers</h3>
<table style="width:100%; border-collapse:collapse; background-color:white;">
    <thead>
        <tr style="background-color:#ecf0f1;">
            <th style="padding:10px; border:1px solid #ccc;">Name</th>
            <th style="padding:10px; border:1px solid #ccc;">Company</th>
            <th style="padding:10px; border:1px solid #ccc;">Email</th>
            <th style="padding:10px; border:1px solid #ccc;">Status</th>
            <th style="padding:10px; border:1px solid #ccc;">Actions</th>
        </tr>
    </thead>
    <tbody id="sellerTable"></tbody>
</table>

<script>
    $(document).ready(function () {
        $("#totalCustomers").text("12,450");
        $("#activeSellers").text("58");
        $("#ordersTransit").text("143");
        $("#totalRevenue").text("₹12,874,500");

        const customers = [
            { name: "Ravi Kumar", email: "ravi@example.com", mobile: "9876543210", status: "Active" },
            { name: "Sneha Patil", email: "sneha@example.com", mobile: "9123456780", status: "Blocked" },
            { name: "Amit Shah", email: "amit@example.com", mobile: "9988776655", status: "Active" }
        ];
        customers.forEach(c => {
            $("#customerTable").append(`
                    <tr>
                        <td style="padding:10px; border:1px solid #ccc;">${c.name}</td>
                        <td style="padding:10px; border:1px solid #ccc;">${c.email}</td>
                        <td style="padding:10px; border:1px solid #ccc;">${c.mobile}</td>
                        <td style="padding:10px; border:1px solid #ccc;">${c.status}</td>
                        <td style="padding:10px; border:1px solid #ccc;">
                            <button style="padding:5px 10px;">View</button>
                            <button style="padding:5px 10px;">${c.status === "Blocked" ? "Unblock" : "Block"}</button>
                        </td>
                    </tr>
                `);
        });

        $.ajax({
            url: '/Seller/LoadDetailsAsync',
            type: 'GET',
            success: function (response) {
                if (response.success) {
                    const sellers = response.data.seller;
                    // const companies = response.data.company;
                    // const credentials = response.data.credentials;

                    $("#sellerTable").empty();

                    if (sellers.length === 0) {
                        $("#sellerTable").append(`<tr><td colspan="5" style="text-align:center; padding:10px;">No sellers found.</td></tr>`);
                    }

                    sellers.forEach(s => {
                        const companyName = s.company?.name ?? "N/A";
                        const loginEmail = s.sellerLogin?.email ?? s.email ?? "N/A";
                        const status = s.isActive ? "Active" : "Inactive";

                        $("#sellerTable").append(`
                                    <tr>
                                        <td style="padding:10px; border:1px solid #ccc;">${s.fullName ?? "N/A"}</td>
                                         <td style="padding:10px; border:1px solid #ccc;">${companyName}</td>
                                        <td style="padding:10px; border:1px solid #ccc;">${loginEmail}</td>
                                         <td style="padding:10px; border:1px solid #ccc;">${status ?? "Pending"}</td>
                                         <td style="padding:10px; border:1px solid #ccc;">
                                            <button class="btn btn-sm btn-success me-2">Approve</button>
                                            <button class="btn btn-sm btn-danger">Suspend</button>
                                        </td>
                                    </tr>
                         `);
                    });
                } else {
                    alert("Failed to load sellers.");
                }
            },
            error: function (xhr, status, error) {
                console.error("AJAX Error:", {
                    status: status,
                    error: error,
                    responseText: xhr.responseText
                });

                alert("Error loading sellers: " + (xhr.responseJSON?.message || error || "Unknown error occurred."));
            }
        });
    });
</script>